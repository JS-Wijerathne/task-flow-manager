# Temp Ops — Shared Package

Shared TypeScript types, enums, and Zod validation schemas consumed by both the **backend** and **frontend** packages.

Published as `@temp-ops/shared` via a local `file:` dependency.

---

## Table of Contents

1. [Purpose](#purpose)
2. [Project Structure](#project-structure)
3. [Getting Started](#getting-started)
4. [Exported Types](#exported-types)
5. [Exported Schemas](#exported-schemas)
6. [How It's Consumed](#how-its-consumed)
7. [Available Scripts](#available-scripts)

---

## Purpose

This package serves as the **single source of truth** for:

- **Enums** — `UserRole`, `ProjectRole`, `TaskStatus`, `AuditAction`
- **DTOs** — TypeScript interfaces for API request/response shapes
- **Validation schemas** — Zod schemas for form and API validation

By sharing these definitions, the frontend and backend stay perfectly synchronized — a type change in one place automatically propagates to both.

---

## Project Structure

```
shared/
├── src/
│   ├── index.ts            # Re-exports everything
│   ├── types/
│   │   └── index.ts        # Enums + DTO interfaces
│   └── schemas/
│       └── index.ts        # Zod validation schemas + inferred types
├── dist/                   # Compiled output (generated by `npm run build`)
│   ├── index.js
│   ├── index.d.ts
│   ├── types/
│   └── schemas/
├── tsconfig.json
└── package.json
```

---

## Getting Started

```bash
cd shared

# Install dependencies (just zod + typescript)
npm install

# Build the package (compiles to dist/)
npm run build
```

> **Important:** You must run `npm run build` before the frontend or backend can resolve `@temp-ops/shared` imports. The `main` and `types` fields in `package.json` point to `dist/`.

---

## Exported Types

### Enums

| Enum          | Values                            | Used For                    |
| ------------- | --------------------------------- | --------------------------- |
| `UserRole`    | `ADMIN`, `MEMBER`, `VIEWER`       | Global user roles           |
| `ProjectRole` | `MEMBER`, `VIEWER`                | Per-project membership role |
| `TaskStatus`  | `TODO`, `IN_PROGRESS`, `DONE`     | Task workflow states        |
| `AuditAction` | `CREATE`, `UPDATE`, `DELETE`      | Audit log action types      |

### DTO Interfaces

| Interface               | Description                                          |
| ----------------------- | ---------------------------------------------------- |
| `UserDTO`               | User without password (id, email, name, role)        |
| `UserWithPasswordDTO`   | User with password field                             |
| `ProjectDTO`            | Project base fields                                  |
| `ProjectWithMembersDTO` | Project + members array + task count                 |
| `ProjectMemberDTO`      | Project membership join record                       |
| `TaskDTO`               | Full task with optional assignee/reporter            |
| `AuditLogDTO`           | Audit log entry with optional actor                  |
| `ProjectAnalyticsDTO`   | Analytics dashboard data structure                   |
| `PaginatedResponse<T>`  | Generic paginated response with meta                 |
| `LoginRequestDTO`       | Login request shape                                  |
| `LoginResponseDTO`      | Login response (token + user)                        |
| `AuthenticatedUserDTO`  | JWT payload shape                                    |

---

## Exported Schemas

All schemas are Zod-based and can be used for both **server-side validation** (Express middleware) and **client-side validation** (React Hook Form).

### Auth Schemas

| Schema           | Fields                                  |
| ---------------- | --------------------------------------- |
| `LoginSchema`    | `email` (email), `password` (min 6)     |
| `RegisterSchema` | `email`, `name` (min 2), `password`, `role?` |

### Project Schemas

| Schema                       | Fields                                   |
| ---------------------------- | ---------------------------------------- |
| `CreateProjectSchema`        | `name` (3–100 chars), `description?`     |
| `UpdateProjectSchema`        | `name?`, `description?` (nullable)       |
| `AddProjectMemberSchema`     | `userId` (UUID), `projectRole`           |
| `UpdateProjectMemberRoleSchema` | `projectRole`                         |

### Task Schemas

| Schema             | Fields                                                       |
| ------------------ | ------------------------------------------------------------ |
| `CreateTaskSchema` | `title` (3–200), `description?`, `priority?`, `dueDate?`, `assigneeId?` |
| `UpdateTaskSchema` | All fields optional + `status?`                              |

### Query Schemas

| Schema             | Fields                                       |
| ------------------ | -------------------------------------------- |
| `PaginationSchema` | `page` (default 1), `pageSize` (default 20)  |
| `TaskFilterSchema` | Extends pagination + `status?`, `assigneeId?`, `search?` |

### Inferred Types

Every schema exports a corresponding TypeScript type via `z.infer<>`:

```typescript
import { CreateTaskSchema, CreateTaskInput } from '@temp-ops/shared';
// CreateTaskInput = z.infer<typeof CreateTaskSchema>
```

---

## How It's Consumed

### In `frontend/package.json`:
```json
{
  "dependencies": {
    "@temp-ops/shared": "file:../shared"
  }
}
```

### In frontend code:
```typescript
import { UserRole, TaskStatus, ProjectMemberDTO } from '@temp-ops/shared';
import { CreateTaskSchema, CreateTaskInput } from '@temp-ops/shared';
```

### In backend:
The backend uses **Prisma-generated types** as its source of truth (since Prisma owns the database schema). The shared package mirrors those enums for frontend consumption. The backend does not directly depend on this package.

---

## Available Scripts

| Script              | Description                              |
| ------------------- | ---------------------------------------- |
| `npm run build`     | Compile TypeScript to `dist/`            |
| `npm run typecheck` | Type-check without emitting files        |
